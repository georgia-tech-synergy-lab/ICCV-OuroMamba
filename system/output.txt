========= COMPUTE-SANITIZER
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (16,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc78cc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (17,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc78dc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (18,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc78ec is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (19,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc78fc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (20,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc790c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (21,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc791c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (22,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc792c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (23,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc793c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (24,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc794c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (25,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc795c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (26,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc796c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (27,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc797c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (28,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc798c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (48,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7bfc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (49,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c0c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (50,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c1c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (51,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c2c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (52,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c3c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (53,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c4c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (54,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c5c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (55,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c6c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (56,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c7c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (57,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c8c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (58,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7c9c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (59,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7cac is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (60,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bc7cbc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (80,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcabcc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (81,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcabdc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (82,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcabec is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (83,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcabfc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (84,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcac0c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (85,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcac1c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (86,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcac2c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (87,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcac3c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (88,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcac4c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (89,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcac5c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (90,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcac6c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (91,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcac7c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (92,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcac8c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (112,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaefc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (113,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf0c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (114,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf1c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (115,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf2c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (116,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf3c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (117,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf4c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (118,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf5c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (119,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf6c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (120,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf7c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (121,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf8c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (122,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcaf9c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (123,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcafac is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (124,0,0) in block (0,0,0)
=========     Address 0x7fcdf8bcafbc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (112,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd14fc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (113,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd150c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (114,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd151c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (115,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd152c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (116,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd153c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (117,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd154c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (118,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd155c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (119,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd156c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (120,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd157c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (121,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd158c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (122,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd159c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (123,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd15ac is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (124,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd15bc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (16,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdecc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (17,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdedc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (18,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdeec is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (19,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdefc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (20,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdf0c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (21,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdf1c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (22,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdf2c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (23,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdf3c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (24,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdf4c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (25,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdf5c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (26,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdf6c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (27,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdf7c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (28,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bcdf8c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (48,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce1fc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (49,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce20c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (50,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce21c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (51,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce22c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (52,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce23c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (53,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce24c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (54,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce25c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (55,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce26c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (56,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce27c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (57,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce28c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (58,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce29c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (59,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce2ac is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (60,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bce2bc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (80,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd11cc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (81,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd11dc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (82,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd11ec is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (83,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd11fc is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (84,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd120c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (85,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd121c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (86,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd122c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (87,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd123c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
========= Invalid __global__ write of size 16 bytes
=========     at void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<(int)4, (bool)1>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, (int)32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, (int)16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<(int)128, (int)128, (int)64>, cutlass::gemm::GemmShape<(int)64, (int)64, (int)64>, cutlass::gemm::GemmShape<(int)16, (int)8, (int)32>, cutlass::epilogue::thread::LinearCombination<int, (int)4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, (int)4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, (bool)0, (bool)0, (bool)0, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<(int)1>, void>>(T1::Params)+0x9b90
=========     by thread (88,0,0) in block (1,0,0)
=========     Address 0x7fcdf8bd124c is misaligned
=========     and is inside the nearest allocation at 0x7fcdf8a00000 of size 2,097,152 bytes
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x2f26ef]
=========                in /usr/lib64/libcuda.so.1
=========     Host Frame: [0x1498b]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6beda]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/lib/../../nvidia/cuda_runtime/lib/libcudart.so.12
=========     Host Frame:cudaError cudaLaunchKernel<char>(char const*, dim3, dim3, void**, unsigned long, CUstream_st*) [0x5b881]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZL604__device_stub__ZN7cutlass7Kernel2INS_4gemm6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS6_11ColumnMajorELS8_0ELi16EiS7_iNS_4arch15OpClassTensorOpENSA_4Sm80ENS1_9GemmShapeILi128ELi128ELi64EEENSD_ILi64ELi64ELi64EEENSD_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSI_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS1_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSA_29OpMultiplyAddMixedInputUpcastELNS1_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS6_9NoPermuteESU_SU_vE10SelectBaseISR_vEEEEvNT_6ParamsERN7cutlass4gemm6kernel13GemmUniversalINS0_11threadblock13MmaMultistageINS0_9GemmShapeILi128ELi128ELi64EEENS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEENS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELi1ENS7_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENSH_ILi2ELi16EEELi32EEENS_5ArrayISD_Li32ELb0EEELb0ENSE_9NoPermuteEEENS8_25RegularTileAccessIteratorISB_SD_NSE_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ESK_Li16EEELNS_4arch14CacheOperation4KindE1ENS9_INSA_ILi64ELi128EEEaNSE_11ColumnMajorELi0ENSG_ISI_Li128ENSH_ILi4ELi8EEELi16EEENSL_IaLi16ELb0EEELb0ESN_EENSP_ISW_aNSE_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ESZ_Li16EEELSV_1EiSF_NS3_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpINS5_ILi64ELi64ELi64EEESD_SR_aS13_iSF_NS16_17MmaTensorOpPolicyINST_3MmaINS5_ILi16ELi8ELi32EEELi32EaSF_aSX_iSF_NST_21OpMultiplyAddSaturateEEENSA_ILi1ELi1EEEEELi1ELb0EbEENSA_ILi0ELi0EEES1H_Li1EEELi4ELNS0_23SharedMemoryClearOptionE0EbEENS_8epilogue11threadblock8EpilogueIS6_S1G_Li1ENS1M_22PredicatedTileIteratorINS1M_26OutputTileOptimalThreadMapINS1M_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS1Q_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESN_Lb0EEENS1L_4warp24FragmentIteratorTensorOpIS18_S1B_iNSL_IiLi4ELb1EEESF_EENS1V_20TileIteratorTensorOpIS18_S1B_iSF_EENS1M_18SharedLoadIteratorINS1T_18CompactedThreadMapEiLi16EEENS1L_6thread17LinearCombinationIiLi4EiNS_6half_tELNS24_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENSA_ILi0ELi8EEELi1ELi1EEENS3_30GemmIdentityThreadblockSwizzleILi1EEEvvE6ParamsE [0x5b1d9]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::__wrapper__device_stub_Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params&) [0x5b1f7]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void cutlass::Kernel2<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >(cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void>::Params) [0x5b8a2]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cutlass::gemm::device::GemmUniversalBase<cutlass::gemm::kernel::DefaultGemmUniversal<cutlass::integer_subbyte<4, true>, cutlass::layout::RowMajor, (cutlass::ComplexTransform)0, 32, signed char, cutlass::layout::ColumnMajor, (cutlass::ComplexTransform)0, 16, int, cutlass::layout::RowMajor, int, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::thread::LinearCombination<int, 4, int, cutlass::half_t, (cutlass::epilogue::thread::ScaleType::Kind)0, (cutlass::FloatRoundStyle)2, int>, cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, 4, cutlass::arch::OpMultiplyAddMixedInputUpcast, (cutlass::gemm::SharedMemoryClearOption)0, false, false, false, cutlass::layout::NoPermute, cutlass::layout::NoPermute, cutlass::layout::NoPermute, void>::SelectBase<cutlass::gemm::threadblock::GemmIdentityThreadblockSwizzle<1>, void> >::run(CUstream_st*, cutlass::CudaHostAdapter*) [0x7dc94]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:_ZN7cutlass4gemm6device17GemmUniversalBaseINS0_6kernel20DefaultGemmUniversalINS_15integer_subbyteILi4ELb1EEENS_6layout8RowMajorELNS_16ComplexTransformE0ELi32EaNS7_11ColumnMajorELS9_0ELi16EiS8_iNS_4arch15OpClassTensorOpENSB_4Sm80ENS0_9GemmShapeILi128ELi128ELi64EEENSE_ILi64ELi64ELi64EEENSE_ILi16ELi8ELi32EEENS_8epilogue6thread17LinearCombinationIiLi4EiNS_6half_tELNSJ_9ScaleType4KindE0ELNS_15FloatRoundStyleE2EiEENS0_11threadblock30GemmIdentityThreadblockSwizzleILi1EEELi4ENSB_29OpMultiplyAddMixedInputUpcastELNS0_23SharedMemoryClearOptionE0ELb0ELb0ELb0ENS7_9NoPermuteESV_SV_vE10SelectBaseISS_vEEEclERKNS3_13GemmUniversalINSQ_13MmaMultistageISF_NS_9transform11threadblock28PredicatedTileAccessIteratorINS_11MatrixShapeILi128ELi64EEES6_S8_Li1ENS12_29PitchLinearWarpRakedThreadMapINS_16PitchLinearShapeILi64ELi128EEELi128ENS18_ILi2ELi16EEELi32EEENS_5ArrayIS6_Li32ELb0EEELb0ESV_EENS13_25RegularTileAccessIteratorIS16_S6_NS7_37RowMajorTensorOpMultiplicandCrosswiseILi4ELi64EEELi0ES1B_Li16EEELNSB_14CacheOperation4KindE1ENS14_INS15_ILi64ELi128EEEaSA_Li0ENS17_IS19_Li128ENS18_ILi4ELi8EEELi16EEENS1C_IaLi16ELb0EEELb0ESV_EENS1F_IS1L_aNS7_40ColumnMajorTensorOpMultiplicandCrosswiseILi8ELi64EEELi1ES1N_Li16EEELS1K_1EiS8_NSQ_9MmaPolicyINS0_4warp21MmaMixedInputTensorOpISG_S6_S1H_aS1R_iS8_NS1U_17MmaTensorOpPolicyINSB_3MmaISH_Li32EaS8_aSA_iS8_NSB_21OpMultiplyAddSaturateEEENS15_ILi1ELi1EEEEELi1ELb0EbEENS15_ILi0ELi0EEES23_Li1EEELi4ELSU_0EbEENSI_11threadblock8EpilogueISF_S22_Li1ENS26_22PredicatedTileIteratorINS26_26OutputTileOptimalThreadMapINS26_15OutputTileShapeILi128ELi8ELi2ELi1ELi1EEENS2A_ILi1ELi8ELi1ELi1ELi8EEELi128ELi4ELi32EEEiLb0ESV_Lb0EEENSI_4warp24FragmentIteratorTensorOpISG_SH_iNS1C_IiLi4ELb1EEES8_EENS2F_20TileIteratorTensorOpISG_SH_iS8_EENS26_18SharedLoadIteratorINS2D_18CompactedThreadMapEiLi16EEESP_NS15_ILi0ELi8EEELi1ELi1EEESS_vvE9ArgumentsEPvP11CUstream_stPNS_15CudaHostAdapterE [0x7547c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:CutlassInt4Int8Gemm(int, int, int, cutlass::integer_subbyte<4, true> const*, int, signed char const*, int, int*, int, cutlass::half_t, cutlass::half_t) [0x58b03]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:custom_gemm_with_outliers(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor) [0x59ee6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:void pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call_impl<void, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul, pybind11::detail::void_type>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), std::integer_sequence<unsigned long, 0ul, 1ul, 2ul, 3ul, 4ul, 5ul, 6ul>, pybind11::detail::void_type&&) && [0x92f2e]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:std::enable_if<std::is_void<void>::value, pybind11::detail::void_type>::type pybind11::detail::argument_loader<at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor>::call<void, pybind11::detail::void_type, void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor)) && [0x8dde6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#3}::operator()(pybind11::detail::function_call&) const [0x867ff]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling, char [114]>(void (*&)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, float, float, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&, char const (&) [114])::{lambda(pybind11::detail::function_call&)#1}::_FUN(pybind11::detail::function_call&) [0x86b8f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x6c2c5]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/custom_quantization_cuda-0.0.0-py3.10-linux-x86_64.egg/custom_quantization_cuda.cpython-310-x86_64-linux-gnu.so
=========     Host Frame:cfunction_call in /usr/local/src/conda/python-3.10.16/Objects/methodobject.c:543 [0xfdcf6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyObject_MakeTpCall in /usr/local/src/conda/python-3.10.16/Objects/call.c:215 [0xf747a]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_EvalFrameDefault in /usr/local/src/conda/python-3.10.16/Python/ceval.c:4181 [0xf3515]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyEval_Vector in /usr/local/src/conda/python-3.10.16/Python/ceval.c:5067 [0x1953a1]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:PyEval_EvalCode in /usr/local/src/conda/python-3.10.16/Python/ceval.c:1134 [0x1952e6]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_eval_code_obj in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1291 [0x1c6736]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:run_mod in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1312 [0x1c186f]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:pyrun_file.cold in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:1208 [0x59838]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_SimpleFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:456 [0x1bbdfe]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:_PyRun_AnyFileObject in /usr/local/src/conda/python-3.10.16/Python/pythonrun.c:90 [0x1bbb62]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_RunMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:674 [0x1b891c]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:Py_BytesMain in /usr/local/src/conda/python-3.10.16/Modules/main.c:1094 [0x1885d8]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
=========     Host Frame:__libc_start_main [0x3524c]
=========                in /lib64/libc.so.6
=========     Host Frame: [0x18848d]
=========                in /global/homes/h/hxu398/.conda/envs/ptq4vm/bin/python3
========= 
[dequantize_inliers_kernel] CUDA error: unspecified launch failure
Traceback (most recent call last):
  File "/global/u1/h/hxu398/quant/custom_quantizer/test_submission.py", line 70, in <module>
    torch.cuda.synchronize()
  File "/global/homes/h/hxu398/.conda/envs/ptq4vm/lib/python3.10/site-packages/torch/cuda/__init__.py", line 783, in synchronize
    return torch._C._cuda_synchronize()
RuntimeError: CUDA error: unspecified launch failure
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

========= Target application returned an error
========= ERROR SUMMARY: 212 errors
========= ERROR SUMMARY: 112 errors were not printed. Use --print-limit option to adjust the number of printed errors
